#!/usr/bin/env python

import sys
import pathlib
import shutil

if len(sys.argv) != 2 and len(sys.argv) != 3:
    print("Usage: new-year YEAR [extension]")
    print("Missing argument 'YEAR'")
    exit(1)

year = sys.argv[1]
suffix = sys.argv[2] or "py"

root = pathlib.Path(__file__).parent.parent

year_dir = root / year
for day in range(1, 13):
    day_dir = year_dir / f'day{str(day).zfill(2)}'
    day_dir.mkdir(parents=True, exist_ok=True)

    solution = day_dir / f'day{day}.{suffix}'

    shutil.copyfile(str(root / 'bin' / 'templates' / suffix), str(solution))

    with open(solution, 'r') as f:
        content = f.read()

    updated = content.replace('REPLACE_YEAR', year).replace('REPLACE_DAY', str(day))

    with open(solution, 'w') as f:
        f.write(updated)
